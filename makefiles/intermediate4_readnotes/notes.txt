I don't think this actually works correctly. Revise
